node {    
    try {
        stage('Clone sources'){            
            checkout scm
        }
        stage('Check environment'){            
            sh "mvn -v"
            sh "java -version"
        }
        stage ('test'){            
            sh "mvn -f pom.xml clean install"
            sh "mvn -f pom.xml clean test"
        }    
        stage ('package'){
            sh "mvn package"
        }    
        stage ('report'){
            step([$class: 'JUnitResultArchiver', testResults: '**/target/surefire-reports/TEST-*.xml'])
        }    
        stage ('Artifact'){
            step([$class: 'ArtifactArchiver', artifacts: '**/target/*.jar', fingerprint: true])
        }    
    }catch(e){
      throw e;
    }
}